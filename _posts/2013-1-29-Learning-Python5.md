---
title: 《Learning Python》学习笔记——5.字符串
time: 2013-1-29
layout: post
category: Python
---
Python字符串——一个有序的字符的集合。
Python的字符串被划分为不可变序列，意味着它们不可以在原处修改。
常见的字符串常量和表达式。

|-----------------------------+---------------------------------------------|
|    操作                     |       解释                                  |
|:----------------------------|:--------------------------------------------|
|  s=''                       |    空字符串                                 |
|  s="spam's"                 |    双引号和单引号相同                       |
|  s='s\np\ta\x00m'           |    转义序列                                 |
|  s="""..."""                |    三重引号字符串块                         |
|  s=r'\temp\spam'            |    Raw字符串                                |
|  s=b'spam'                  |    Python3.0中的字节字符串                  |
|  s=u'spam'                  |    仅在Python2.6中使用的Unicode字符串       |
|  s1+s2                      |    合并                                     |
|  s * 3                      |    重复                                     |
|  s[i]                       |    索引                                     |
|  s[i:j]                     |    分片                                     |
|  len(s)                     |    长度                                     |
|  "a %s parrot" % kind       |    字符串格式化表达式                       |
|  "a {0} parrot".format(kind)|    Python2.6和Python3.0中的字符串格式化方法 |
|  s.find('pa')               |    字符串方法调用:搜索                      |
|  s.rstrip()                 |    移除空格                                 |
|  s.replace('pa','xx')       |    替换                                     |
|  s.split(',')               |    用展位符分隔                             |
|  s.isdigit()                |    内容测试                                 |
|  s.lower()                  |    短信息转换                               |
|  s.endswidth()              |    结束测试                                 |
|  'spam'.join(strlist)       |    插入分隔符                               |
|  s.encode('latin-1')        |    Unicode编码                              |
|  for x in S:print(x)        |    迭代                                     |
|  'spam' in X                |                                             |
|  [c * 2 for c in S]         |                                             |
|  map(ord,S)                 |                                             | 
|-----------------------------+---------------------------------------------|

#字符串常量#

##单双引号字符串是一样的##

在Python中，单引号和双引号字符是可以互换的
此外，Python自动在任意的表达式中合并相邻的字符串常量，尽管可以简单地在它们之间增加+操作符来明确地表示这是一个合并操作。

##用转义序列代表特殊字节##

反斜杠用来引入特殊的字节编码——转义序列。
转义序列让我们能够在字符串中嵌入不容易通过键盘输入的字节。

|-------------+------------------------------|
|  转义       |   意义                       |
|:-----------:|:-----------------------------|
|  \newline   |   忽视(连续)                 |
|  \\         |   反斜杠(保留\)              |
|  \'         |   单引号(保留')              |
|  \"         |   双引号(保留")              |
|  \a         |   响铃                       |
|  \b         |   倒退                       |
|  \f         |   换页                       |
|  \n         |   新行(换行)                 |
|  \r         |   返回                       |
|  \t         |   水平制表符                 |
|  \v         |   垂直制表符                 |
|  \N{id}     |   Unicode数据库ID            |
|  \uhhhh     |   Unicode16位的十六进制值    |
|  \UHHHHHHHH |   Unicode32位的十六进制值    |
|  \xhh       |   十六进制                   |
|  \ooo       |   八进制                     |
|  \0         |   Null(不是字符串结尾)       |
|  \other     |   不转义(保留)               |
|---------------+------------------------------|

##raw字符串抑制转义##

如果字母r(大写或小写)出现在字符串的第一引号的前面，它将会关闭转移机制。


##三重引号编写多行字符串块##

Python还有一种三重引号的字符串常量格式，有时称作块字符串。这个形式以三重引号开始(单引号双引号都可以)，并紧跟任意行数的文本，并且以开始时同样的三重引号结尾。

#实际应用中的字符串#

##索引和分片##

**索引(S[i])获取特定偏移的元素:**

- 第一个元素的偏移为0
- 负偏移索引意味着从最后或右边反向进行计数
- S[0]获取了第一个元素
- S[-2]获取了倒数第二个元素

**分片(S[i:j])提取对应的部分作为一个序列:**

- 上边界并不包含在内
- 如果没有给出的话，分片的边界默认为0和序列的长度
- S[1:3]获取了从偏移为1的元素，直到但不包括偏移为3的元素
- S[1:]获取了从偏移为1直到末尾(偏移为序列长度)之间的元素
- S[:3]获取了从偏移为0直到但是不包括偏移为3之间的元素
- S[:-1]获取了从偏移为0直到但不包括最后一个元素之间的元素
- S[:]获取了从偏移0到末位之间的所有元素，这有效地实现了顶层S拷贝

分片表达式，还可以有第三个索引参数，用作步长，完整形式的分片变成了:X[I:J:K],这表示:**索引X对象中的元素，从偏移为I直到偏移为J-1，每隔K元素索引一次**。

##字符串转换工具##

int():将字符串转换为数字
str():将数字转换为字符串表达形式
float():将字符串转换为浮点数

**字符串代码转换**

ord():将单个字符转换为对应的ASCII码
chr():获取ASCII码并将其转化为对应的字符

#字符串方法#

除了表达式运算符之外，字符串还提供了一系列的方法去实现更复杂的文本处理任务。方法就是与特定的对象相关联在一起的函数。从技术角度来讲，它们附属于对象的属性，而这些属性不过是些可调用的函数罢了。

字符串是不可变的，所以不能在远处直接对其进行修改。为了在已存在字符串中创建新的文本值，我们可以通过分片和合并这样的操作来建立新的字符串。

#字符串格式化表达式#

如今的Python中的字符串格式化可以以两种形式实现:

**字符串格式化表达式**

这是从Python诞生的时候就有的最初的技术；这是基于C语言的"printf"模型，并且在大多数现有的代码中使用。

**字符串格式化方法调用**

这是Python2.6和Python3.0新增加的技术，这是Python独有的方法，并且和字符串格式化表达式的功能有很大重叠。

{% highlight python %}
'That is %d %s bird!' % (1,'dead')
{% endhighlight %}

上述代码的结果就是:That is 1 dead bird!

从技术上讲，字符串的格式化表达式往往是可选的——通常你可以使用多次的多字符串的合并和转换达到类似的目的。然后格式化允许我们将多个步骤合并为一个简单的操作，这一功能相当强大。

需要注意的是:格式化总是会返回新的字符串作为结果，而不是对左侧的字符串进行修改。

字符串格式化代码

|---------+-------------------------------|
|  代码   |   意义　　　　　　　　　　　　|
|:-------:|:------------------------------|
|  s      |   字符串(或任何对象)          |
|  r      |   s,但使用repr，而不是str     |
|  c      |   字符                        |
|  d      |   十进制(整数)                |
|  i      |   整数                        |
|  u      |   无号(整数)                  |
|  o      |   八进制数                    |
|  x      |   十六进制数                  |
|  X      |   x，但打印大写               |
|  e      |   浮点指数                    |
|  E      |   e,但打印大写                |
|  f      |   浮点十进制                  |
|  F      |   浮点十进制                  |
|  g      |   浮点e或f                    |
|  G      |   浮点E或f                    |
|  %      |   常量%                       |
|---------+-------------------------------|

事实上，在格式化字符串中，表达式左侧的转换目标支持多种转换操作，这些操作自由一套相当严谨的语法，转换目标的通用结构看上去是这样的:
`%[(name)][flags][width][.precision]typecode`
有关格式化目标的语法在Python的标准手册中都有完整的介绍。


##基于字典的字符串格式化##

字符串的格式化同时也允许左边的转换目标来引用右边字典中的键来提取对应的值。

{% highlight python %}
"%(n)d %(x)s" % {"n":1,"x":"spam"}
{% endhighlight %}

以上代码的结果是:'1 spam'

#字符串格式化调用方法#

##基础知识##

简而言之，Python2.6和Python3.0(及其以后的版本)中的新的字符串对象的format方法使用主体字符串作为模板，并且接受任意多个表示将要根据模板替换的值的参数。在主体字符串中，花括号通过为止或关键字指出替换目标及将要插入的参数。

{% highlight python %}
template='{0},{1} and {2}'
template.format('spam','ham','eggs')
{% endhighlight %}

上述代码的结果是'spam,ham and eggs'

##添加键、属性和偏移量##

格式化字符串可以指定对象属性和字典键，方括号指定字典键，而点表示位置或关键字所引用的一项对象属性。
{% highlight python %}
import sys
'My {1[spam] runs {0.platform}'.format(sys,{'spam':'laptop'})
{% endhighlight %}

上述代码运行的结果是:'My laptop runs win32'

##添加具体格式化##

格式化的语法:

{% highlight python %}
{fieldname!conversionflag:formatspec}
{% endhighlight %}

- fieldname是指定参数的一个数字或关键字，后面跟着可选的".name"或[index]成分引用
- conversionflag可以是r,s后者a分别是在该值上对repr、str或ascii内置函数的一次调用
- formatspec指定了如何表示该值，包括字段宽度、对齐方式、补零、小数点精度等细节，并且以一个可选的数据类型编码结束

更多细节可以查看Python的库手册。

##为什么要新的格式化方法##

格式化方法相对于原来的字符串格式化表达式有以下几个特点:

- 拥有%表达式所没有的一些额外功能
- 可以更加明确地进行替代值引用
- 考虑到操作符会有一个更容易记忆的方法名
- 不支持用于单个和多个替代之大小写的不同语法


#通常意义下的类型分类#

##同样分类的类型共享其操作集合##

在Python中有三个主要类型(以及操作)的分类:

- 数字(整数、浮点数、二进制、分数等)
  支持加法和乘法
- 序列(字符串、列表、元组)
  支持索引、分片和合并等
- 映射(字典)
  支持通过键的索引等

索引、分片以及其他的序列操作对于所有的序列来说都是同样有效的，对象的类型将会告诉Python去执行什么样的任务。

##可变类型能够在原处修改##

Python中的主要核心类型划分为如下两类:

- 不可变类型(数字、字符串、元组、不可变集合)
  不可变的分类中没有哪个对象类型支持原处修改，尽管我们总是可以运行表达式来创建新的对象并将其结果分配给变量
- 可变类型(列表、字典、可变集合)
  相反，可变的类型总是可以通过操作原处修改，而不用创建新的对象



