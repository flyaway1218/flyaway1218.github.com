---
title: 《Learning Python》学习笔记——2.介绍Python对象类型
time: 2013-1-26
layout: post
category: Python
---

Python程序可以分解成模块、语句、表达式以及对象:

1. 程序又模块构成
2. 模块包含语句
3. 语句包含表达式
4. 表达式建立并处理对象

#为什么使用内置类型#

- 内置对象使程序更容易编写
- 内置对象时扩展的组件
- 内置对象往往比定制的数据结构更有效率
- 内置对象是语言标准的一部分

##Python的核心数据类型##

在Python程序中处理的每一样东西都是一种对象，内置对象如下表所示:

|--------------------+----------------------------------------|
|  对象类型          |  例子 常量/创建                        |
|:-------------------|:---------------------------------------|
|  数字              |  1234,3.1415,3+4j,Deciaml,Fraction     |
|  字符串            |  'spam',"guido's",b'a\xolc'            |
|  列表              |  [1,[2,'three'],4]                     |
|  字典              |  {'food':'spam','taste':'yum'}         |
|  元组              |  (1,'spam',4,'U')                      |
|  文件              |  myfile = open('egg','r')              |
|  集合              |  set('abc'),{'a','b','c'}              |
|  其他类型          |  类型、None、布尔型                    |
|  编程单元类型      |  函数、模块、类                        |
|  与实现相关的类型  |  编译的代码堆栈跟踪                    |
|--------------------+----------------------------------------|

像函数、模块和类这样的编程单元在Python中也是对象，它们由def、class、import和lamdba这样的语句和表达式创建，并且可以在脚本间自由地传递，存储在其他对象中。

Python中没有类型声明，运行的表达式的语法决定了创建和使用的对象的类型。一旦创建了一个对象，它就和操作集合绑定了，例如只能对字符串进行字符串相关的操作。

Python是动态类型的(**它自动跟踪你的类型而不是要求声明代码**)，但是他也是强类型语言。(**你只能对一个对象进行适合该类型的有效操作**)

#数字#

Python中的数字支持一般的数学运算，包括加法(+),乘法(*),除法(/),整除(//),取模(%),乘方(**)。

#字符串#

从严格意义上说，字符串是单个字符的字符串的序列，其他类型的序列还包括列表和元组。

##序列的操作##

**索引**

作为序列，字符串支持针对各个元素位置顺序的操作。在Python中，索引是从0开始的，但是我们也可以反向索引，从最后一个开始，-1代表最后一个元素，-2代表倒数第二个元素，以此类推。比较好的记忆方法是:负的索引号简单地与字符串长度相加，就得到了正向的索引号。

**分片**

除了简单的从位置进行索引，序列也支持一种分片(slice)操作，这是一种一步就能够提取整个分片(slice)的方法:

{% highlight python %}
S = 'Spam'
S[1:3]
{% endhighlight %}

它们的一般形式为X[I:J],表示"取出在X中从偏移量为I，直到但不包括偏移量为J的内容"，结果就是返回一个新的对象。
在一个分片中，左边界默认为0，并且右边界默认为分片序列的长度。

**合并**

作为一个序列，字符串也支持使用加号进行合并(将两个字符串合并成为一个新的字符串)。

##不可变性##

字符串在Python具有不可变性，**也就是说在创建后不能就地改变**，但是你总是可以通过建立一个新的字符串并以同一个变量名对其进行赋值，因为Python在运行过程中会清理旧对象。

{% highlight python %}
S = 'Spam'
S = 'z' + S[1:]
print(S)
{% endhighlight %}

在Python中，每一个对象都可以分为不可变性或可变性，在核心类型中，数字、字符串和元组是不可变的，列表和字典是可变的。

##类型特定的方法##

到目前为止讲到的操作都是Python中序列对象共有的，包括列表和元组。字符串也有一些自己特殊的方法。

**find**

字符串的find方法是一个基本的子字符串查找的操作。(它将返回一个传入子字符串的偏移量，或者没有找到的情况下返回-1)

**replace**

replace方法将会对全局进行搜索和替换。

这些字符串的方法都不会改变原来的字符串，只是会生成一个新的字符串对象作为返回对象。

注意:尽管序列操作是通用的，但方法不通用(虽然某些类型共享某些方法名)。一条简明的法则是这样的:**可作用于多种类型的通用型操作都是以内置函数或表达式的形式出现的[例如,len(X),X[0]]，但是类型特定的操作是以方法调用的形式出现的。[例如,aString.find('x')]**

##寻求帮助##

想要查看对象详细的方法，可以调用内置的`dir`函数，它将返回一个列表，其中包含了对象的所有属性。(对象属性包括方法)
`dir`函数简单地给出了方法的名称，要查询它们是做什么的，你可以将其传递给`help`函数。

{% highlight python %}
S = 'Spam'
dir(S)
help(S.replace)
{% endhighlight %}

##编写字符串的其他方法##

在Python中，反斜线转义序列表示特殊的字符，Python允许字符串包括在单引号或双引号中。(它们代表着相同的东西)
Python也支持原始(raw)字符串常量，即去掉反斜线转义机制。

##模式匹配##

Python的字符串对象能够支持基于模式的文本处理，详细的内容后面介绍。

#列表#

Python的列表对象是这个语言提供的最通用的序列。列表是一个任意类型的对象的位置相关的有序集合，它没有固定的大小。

##序列操作##

由于列表是序列的一种，列表支持之前提到的所有序列操作,包括索引、切片等操作。

##类型特定的操作##

Python的列表与其他语言中的数组有些类似，但要强大得多。其中一个方面就是，列表没有固定类型的约束，一个列表中的元素可以是各种不同的类型，其次列表是没有固定大小的，它能够按照需要自己增加或减少列表大小。

- append:扩充列表的大小并在列表的尾部插入一项
- pop:移除给定偏移量的一项，从而让列表减小
- insert:在任意位置插入元素
- remove:按照值移除元素

需要注意的是，大多数列表的方法都会就地改变列表对象，而不是创建一个新的列表。

##边界检查##

尽管列表没有固定的大小，Python仍不允许引用不存在的元素，超出列表末尾之外的索引总是会导致错误。

##嵌套##

Python核心数据类型的一个优秀的特性就是它们支持任意的嵌套，能够以任意的组合对其进行嵌套，并可以多个层次进行嵌套。

#字典#

Python中的字典是完全不同的东西:它们不是序列，而是一种映射(mapping)。映射是一个其他对象的集合，但是它们是通过键而不是相对位置来存储的。实际上，映射并没有任何可靠的从左至右的顺序。它们简单地讲键映射到值。字典是Python核心对象集合中的唯一的一种映射类型，也具有可变性——可以就地改变，并可以随需求增大或减少，就像列表那样。

##映射操作##

作为常量编写时，字典编写在大括号中，并包含一系列的"键:值"对。通过键索引一个字典往往是Python中编写搜索的最快方法。
字典的索引操作使用的是和序列相同的语法，但是在方括号中的元素是键，而不是相对位置。

{% highlight python %}
D={}
D['name']='Bob'
D['job']='dev'
D['age']=40
{% endhighlight %}

##重访嵌套##

{% highlight python %}
rec = {'name':{'first':'Bob','last':'Smith'},
			 'job':['dev','mgr'],
			 'age':40.5 }
{% endhighlight %}

如上面代码所示，Python的核心数据类型是非常灵活的，可以轻松的建立复杂的信息结构。

##键的排序:for循环##

之前说过，字典中是没有顺序的，全部都是以键来进行索引的，但是，如果确实需要强调顺序的时候，可以这样做:

{% highlight python %}
D={'a':1,'b':2,'c':3}
for key in sorted(D):
		print(key,'=>',D[k])
{% endhighlight %}

sorted是内置函数，sorted调用返回结果并对各种对象类型进行排序。

##不存在的键:if测试##

尽管我们能够通过给新的键赋值来扩展字典，但是获取一个不存在的键仍然是一个错误.可以利用in和if进行判断:

{% highlight python %}
D={'a':1,'b':2,'c':3}
if not 'f' in D:
		print('missing')
{% endhighlight %}

#元组#

元组基本上就像一个不可以改变的列表，就像列表一样，元组是序列，但是它具有不可变性，和字符串类似。从语法上讲，它们编写在圆括号中而不是方括号中，他们支持任意类型、任意嵌套以及常见的序列操作。

元组还有两个专有的可调用方法:

- index:返回元素的偏移值
- count:返回元素在元组中出现的次数

##为什么要用元组##

元组在实际应用并不如列表那么常用，但是它的关键在于不可变性。如果在程序中以列表的形式传递一个对象的集合，它可能在任何地方改变，如果使用元组的话，就不能。也就是说，元组提供了一种完整性约束，这对于我们这里所编写的更大型的程序来说是方便的。

#文件#

文件对象是Python代码对计算机上外部文件的主要接口。虽然文件时核心类型，但是它有些特殊:没有特定的常量语法来创建文件。要创建一个文件对象，需要调用内置的open函数以字符串的形式传递给它一个外部的文件名以及一个处理模式的字符串。

{% highlight python %}
f = open('data.txt','w')
f.write('Hello\n')
f.write('World\n')
{% endhighlight %}

#总结#

- Python中的核心对象有:数字、字符串、列表、字典、元组、文件和集合。
- 其中，数字、字符串和元组具有不可变性。
- 字符串、元组、列表是属于序列的，是有顺序的。
- 字典不属于序列，它是没有顺序的。
- Python中的关键思想之一:**不要把代码限制在特定的类型上，使代码自动适用于多种类型**。
