---
layout: post
title: 《鸟哥的Linux私房菜:基础篇》学习笔记——21.Linux备份策略
time: 2013-2-14
category: LinuxBase
published: false
---


#备份要点#

##备份哪些数据##

具有备份意义的文件通常可以粗分为两大类，一类是系统的基本设置信息，一类则是类似网络服务的内容数据。

**操作系统本身需要备份的文件**

这方面的文件主要跟账号与系统配置文件有关，主要有:/etc/passwd、/etc/shadow、/etc/group、/etc/gshadow、/home。由于/etc/下面保存了Linux默认的重要参数文件，所以只要将这个目录备份下来的话，那么几乎所有的配置文件都可以被保存。

另外，如果曾经更改过内核，那么/boot中的信息也是很重要的，所以这方面的数据必须要备份的文件为:

- /etc/整个目录
- /home 整个目录
- /var/spool/mail
- /boot
- /root
- 如果自行安装过其他的套件，那么/usr/local或/opt也最好备份一下。

**网络服务的数据库方面**

这部分的数据多而复杂，如果你的网络软件安装都是以原厂商提供的为主，那么你的配置文件大多数是在/etc下面，然是如果你的套件大多来自自行的安装，那么/usr/local这个目录是相当重要的。

若我们假设我们提供的服务软件都是使用原厂的RPM安装的，所以需要备份的数据文件有:

- 软件本身的配置文件:/etc/整个目录，/usr/local整个目录
- 软件服务提供的数据，以www及MySQL为例：
  
  - www数据:/var/www整个目录或/src/www整个目录，及系统的用户主文件夹
  - MySQL:/var/lib/mysql整个目录

**推荐需要备份的目录**

如果你的硬件或者是由于经费的关系而无法将全部的数据都予以备份时，建议你至少需要备份这些目录:

- /boot
- /etc
- /home
- /usr/local(或者是/opt或/srv)
- /var

**不需要备份的目录**

- /dev:备份与否均可
- /proc:不需要备份
- /mnt与/media:如果没有在这个目录内放置你自己系统的东西，也不需要备份
- /tmp:临时文件，不需要备份

#备份的种类、频率与工具的选择#

##完整备份的增量备份(Incremental backup)##

**增量备份的原则**

所谓的增量备份，指的是在系统进行完第一次备份之后，经过一段时间的运行，比较系统与备份文件之间的差异，仅备份有差异的文件而已。而第二次增量备份则与第一次增量备份的数据比较，也是仅备份有差异的数据而已。如此一来，由于仅备份有差异的数据，因此备份的数据量小且快速，备份也很有效率。

从它的备份方法可以看出，还原的时候，需要所有的备份文文件，因为每一个备份文件都是依赖于上次的备份文件的。

**增量备份使用的备份软件**

完整备份常用的工具有dd,cpio,dump/restore等，因为这些工具都能够备份设备与特殊文件。dd可以直接读取磁盘的扇区(sector)而不理会文件系统，是相当良好的备份工具，不过缺点是慢很多。cpio是能够备份所有文件名，不过，得要配合find或其他找文件名的命令才能处理妥当。以上两个都能够进行完整备份，但增量备份就得要额外使用脚本程序来处理。可以直接进行增量备份的就是dump。

##完整备份的差异备份(different backup)##
差异备份与增量备份有点类似，也是需要进行第一次的完整备份后才能进行。只是差异备份指的是:**每次的备份都是与原始的完整备份比较的结果。**所以系统运行越久，里完整备份时间越长，那么该次的差异备份数据可能就会越大！

